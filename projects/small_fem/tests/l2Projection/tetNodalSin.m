close all;
clear all;

%% l2 [Order][Mesh]

%% Sin(10x) + Sin(10y) + Sin(10z)

h = [1, 1/2, 1/4, 1/8, 1/16];
p = [1:6];

l2 = zeros(6, 5);

l2(1, 0 + 1) = +1.243621e+00;
l2(1, 1 + 1) = +7.101076e-01;
l2(1, 2 + 1) = +2.512927e-01;
l2(1, 3 + 1) = +6.335089e-02;
l2(1, 4 + 1) = +1.391786e-02;

l2(2, 0 + 1) = +1.118168e+00;
l2(2, 1 + 1) = +2.559086e-01;
l2(2, 2 + 1) = +5.033735e-02;
l2(2, 3 + 1) = +8.261842e-03;
l2(2, 4 + 1) = +1.250281e-03;

l2(3, 0 + 1) = +7.054182e-01;
l2(3, 1 + 1) = +1.002849e-01;
l2(3, 2 + 1) = +7.196863e-03;
l2(3, 3 + 1) = +4.568739e-04;
l2(3, 4 + 1) = +2.527776e-05;

l2(4, 0 + 1) = +3.319402e-01;
l2(4, 1 + 1) = +2.079044e-02;
l2(4, 2 + 1) = +9.762910e-04;
l2(4, 3 + 1) = +3.576411e-05;
l2(4, 4 + 1) = +1.224976e-06;

l2(5, 0 + 1) = +3.169679e-01;
l2(5, 1 + 1) = +5.613718e-03;
l2(5, 2 + 1) = +8.712692e-05;
l2(5, 3 + 1) = +1.329101e-06;
l2(5, 4 + 1) = +0; %% Spoofing

l2(6, 0 + 1) = +2.740258e-01;
l2(6, 1 + 1) = +1.343975e-03;
l2(6, 2 + 1) = +8.953117e-06;
l2(6, 3 + 1) = +7.698335e-08;
l2(6, 4 + 1) = +0; %% Spoofing

P = size(p, 2);
H = size(h, 2);

delta = zeros(P, H - 1);

for i = 1:H-1
    delta(:, i) = ...
        (log10(l2(:, i + 1)) - log10(l2(:, i))) / ...
        (log10(1/h(i + 1))   - log10(1/h(i)));
end

delta

figure;
loglog(1./h, l2, '-*');
grid;
