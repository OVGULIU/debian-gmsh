close all;
clear all;

%% l2 [Order][Mesh]

%% f = Sin(10x)

h = [1, 1/2, 1/4, 1/8, 1/16];
p = [1:5];

l2 = ...
    [...
        +1.075659e+00 , +5.732410e-01 , +2.285537e-01 , +5.748644e-02 , +1.456107e-02 ; ...
        +9.735609e-01 , +3.151548e-01 , +3.938404e-02 , +5.679590e-03 , +7.223539e-04 ; ...
        +4.984880e-01 , +8.118949e-02 , +7.865903e-03 , +4.826276e-04 , +3.046449e-05 ; ...
        +4.984917e-01 , +2.745846e-02 , +7.932871e-04 , +2.827457e-05 , +8.937159e-07 ; ...
        +9.648212e-02 , +4.488822e-03 , +1.052306e-04 , +1.594444e-06 , +2.514015e-08 ; ...
    ];

P = size(p, 2);
H = size(h, 2);

delta = zeros(P, H - 1);

for i = 1:H-1
    delta(:, i) = ...
        (log10(l2(:, i + 1)) - log10(l2(:, i))) / ...
        (log10(1/h(i + 1))   - log10(1/h(i)));
end

delta

figure;
loglog(1./h, l2', '-*');
grid;
