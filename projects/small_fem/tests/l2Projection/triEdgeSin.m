close all;
clear all;

%% l2 [Order][Mesh]

%% f = [Sin(10x),  Sin(10y)]

h = [1, 1/2, 1/4, 1/8, 1/16];
p = [1:5];

l2 = ...
    [...
        +9.932498e-01 , +7.168849e-01 , +1.923415e-01 , +5.260378e-02 , +1.302612e-02 ; ...
        +8.647524e-01 , +2.471900e-01 , +4.948087e-02 , +6.671287e-03 , +8.837262e-04 ; ...
        +7.616460e-01 , +1.056592e-01 , +6.330399e-03 , +4.046649e-04 , +2.388441e-05 ; ...
        +2.789857e-01 , +2.017473e-02 , +9.695710e-04 , +3.314052e-05 , +1.060491e-06 ; ...
        +2.198947e-01 , +5.865335e-03 , +8.467531e-05 , +1.304785e-06 , +2.197048e-08 ; ...
    ];

P = size(p, 2);
H = size(h, 2);

delta = zeros(P, H - 1);

for i = 1:H-1
    delta(:, i) = ...
        (log10(l2(:, i + 1)) - log10(l2(:, i))) / ...
        (log10(1/h(i + 1))   - log10(1/h(i)));
end

delta

figure;
loglog(1./h, l2', '-*');
grid;
